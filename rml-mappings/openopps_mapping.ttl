# RML prefixes
@prefix rr:       <http://www.w3.org/ns/r2rml#> .
@prefix rml:      <http://semweb.mmlab.be/ns/rml#> .
@prefix ql:       <http://semweb.mmlab.be/ns/ql#> .

# Own prefixes
@base             <http://data.tbfy.eu/> .
@prefix tbfy:     <http://data.tbfy.eu/ontology/tbfy/> . 
@prefix ocds:     <http://data.tbfy.eu/ontology/ocds/> .

# External prefixes
@prefix dc:       <http://purl.org/dc/terms/> .
@prefix foaf:     <http://xmlns.com/foaf/0.1/> .
@prefix owl:      <http://www.w3.org/2002/07/owl#> .
@prefix rdf:      <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix schema:   <http://schema.org/> .
@prefix xsd:      <http://www.w3.org/2004/02/skos/core#> .


# *********************************
# Contracting Process mapping rules
# *********************************

<ContractingProcessMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contractingProcess/{ocid}" ;
    rr:class ocds:ContractingProcess
  ];
  
  rr:predicateObjectMap [
    rr:predicate ocds:hasPlan ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/plan/{plans.[*].id}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasTender ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{tender.id}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasAward ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{awards.[*].id}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasContract ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contract/{contracts.[*].id}"
    ]
  ].

<ContractingProcessBuyerMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contractingProcess/{ocid}/buyer" ;
    rr:class ocds:Organisation
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasName ;
    rr:objectMap [
      rml:reference "buyer.name"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasContactPoint ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contractingProcess/{ocid}/buyer/contactPoint"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasAddress ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contractingProcess/{ocid}/buyer/address"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:isBuyerFor ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contractingProcess/{ocid}/contract"
    ]
  ];
        
  rr:predicateObjectMap [
    rr:predicate ocds:isBuyerFor ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contractingProcess/{ocid}"
    ]
  ];
          
  rr:predicateObjectMap [
    rr:predicate ocds:playsRoleIn ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contractingProcess/{ocid}"
    ]
  ].

<ContractProcessBuyerAddressMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contractingProcess/{ocid}/buyer/address";
    rr:class ocds:Address
  ];

  rr:predicateObjectMap [
    rr:predicate schema:addressLocality ;
    rr:objectMap [
      rml:reference "buyer.address.locality" 
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate schema:postalCode ;
    rr:objectMap [
      rml:reference "buyer.address.postalCode" 
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate schema:addressCountry ;
    rr:objectMap [
      rml:reference "buyer.address.countryName" 
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate schema:streetAddress ;
    rr:objectMap [
      rml:reference "buyer.address.streetAddress" 
    ]
  ].

<ContractProcessBuyerContactpointMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contractingProcess/{ocid}/buyer/contactPoint" ;
    rr:class ocds:ContactPoint ;
    rr:class ocds:Person
  ];
  
  rr:predicateObjectMap [
    rr:predicate schema:addressLocality ;
    rr:objectMap [
      rml:reference "buyer.address.locality"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:postalCode ;
    rr:objectMap [
      rml:reference "buyer.address.postalCode"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:addressCountry ;
    rr:objectMap [
      rml:reference "buyer.address.countryName"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:streetAddress ;
    rr:objectMap [
      rml:reference "buyer.address.streetAddress"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:email ;
    rr:objectMap [
      rml:reference "buyer.contactPoint.email"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:name ;
    rr:objectMap [
      rml:reference "buyer.contactPoint.name"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:telephone ;
    rr:objectMap [
      rml:reference "buyer.contactPoint.telephone"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:URL ;
    rr:objectMap [
      rml:reference "buyer.contactPoint.url"
    ]
  ].


# ********************
# Tender mapping rules
# ********************

<TenderMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].tender"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{id}" ;
    rr:class ocds:Tender
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:tenderId ;
    rr:objectMap [
      rml:reference "id"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasItemToBeProcured ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/item/{items.[*].id}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate dc:title ;
    rr:objectMap [ 
      rml:reference "title" 
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:tenderStatus ;
    rr:objectMap [
      rml:reference "tender.status"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasMaxEstimatedValue ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/maxValue"
    ]
  ];
 
  rr:predicateObjectMap [
    rr:predicate ocds:hasMinEstimatedValue ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/minValue"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasDocument ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/document/{documents.[*].id}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasMilestone ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/milestone/{milestones.[*].id}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate dc:description ;
    rr:objectMap [ 
      rml:reference "description" 
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:enquiry ;
    rr:objectMap [
      rml:reference "hasEnquiries" 
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasTenderPeriod ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/period"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:awardCriteria ;
    rr:objectMap [
      rml:reference "awardCriteria"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:submissionMethod ;
    rr:objectMap [
      rml:reference "submissionMethod"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:procurementMethod ;
    rr:objectMap [
      rml:reference "procurementMethod"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:eligibilityCriteria ;
    rr:objectMap [
      rml:reference "eligibilityCriteria"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:awardCriteriaDetails ;
    rr:objectMap [
      rml:reference "awardCriteriaDetails"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:submissionMethodDetails ;
    rr:objectMap [
      rml:reference "submissionMethodDetails"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:procurementMethodDetails ;
    rr:objectMap [
      rml:reference "procurementMethodDetails"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:procurementMethodRationale ;
    rr:objectMap [
      rml:reference "procurementMethodRationale"
    ]
  ];
   
  rr:predicateObjectMap [
    rr:predicate dc:language ;
    rr:objectMap [
      rml:reference "language"
    ]
  ];
            
  rr:predicateObjectMap [
    rr:predicate ocds:hasEnquiryPeriod ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/enquiryPeriod"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasEstimatedContractPeriod ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/estimatedContractPeriod"
    ]
  ];
            
  rr:predicateObjectMap [
    rr:predicate ocds:hasLot ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/lot/{lots.[*].id}"
    ]
  ];
   
  rr:predicateObjectMap [
    rr:predicate ocds:hasReceivedBid ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/bid/{bids.[*].id}"
    ]
  ];
 
  rr:predicateObjectMap [
    rr:predicate ocds:hasRequirement ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{id}/requirement/{requirements.[*].id}"
    ]
  ].
  
<TenderItemMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].tender.items.[*]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tbfy_tender_id}/item/{id}" ;
    rr:class ocds:Item
  ];
     
  rr:predicateObjectMap [
    rr:predicate ocds:itemId ;
    rr:objectMap [
      rml:reference "id"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate dc:description ;
    rr:objectMap [ 
      rml:reference "description" 
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasClassificaton ;
    rr:objectMap [
      rml:reference "classification.id"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:classificatonScheme ;
    rr:objectMap [
      rml:reference "classification.scheme"
    ]
  ];
        
  rr:predicateObjectMap [
    rr:predicate ocds:hasAdditionalItemClassificaton ;
    rr:objectMap [
      rml:reference "additionalClassifications.[*].id"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:additionalItemClassificatonScheme ;
    rr:objectMap [
      rml:reference "additionalClassifications.[*].scheme"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:isRelatedToLot ;
    rr:objectMap [
      rml:reference "relatedLot"
    ]
  ].

<TenderMaxValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].tender.[*].maxValue"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tbfy_tender_id}/maxValue" ;
    rr:class ocds:Value
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:valueAmount ;
    rr:objectMap [
      rml:reference "amount"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:valueCurrency ;
    rr:objectMap [
      rml:reference "currency"
    ]
  ].

<TenderMinValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].tender.minValue"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tbfy_tender_id}/minValue" ;
    rr:class ocds:Value
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:valueAmount ;
    rr:objectMap [
      rml:reference "amount"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:valueCurrency ;
    rr:objectMap [
      rml:reference "currency"
    ]
  ].

<TenderDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].tender.documents.[*]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tbfy_tender_id}/document/{id}" ;
    rr:class ocds:Document
  ];
    
  rr:predicateObjectMap [
    rr:predicate ocds:documentId ;
    rr:objectMap [
      rml:reference "id"
    ]
  ];
    
  rr:predicateObjectMap [
    rr:predicate ocds:documentType ;
    rr:objectMap [
      rml:reference "documentType"
    ]
  ];
    
  rr:predicateObjectMap [
    rr:predicate dc:language ;
    rr:objectMap [
      rml:reference "language"
    ]
  ];
    
  rr:predicateObjectMap [
    rr:predicate schema:URL ;
    rr:objectMap [
      rml:reference "url"
    ]
  ].

<TenderMilestoneMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].tender.milestones.[*]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tbfy_tender_id}/milestone/{id}" ;
    rr:class ocds:Milestone
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:documentId ;
    rr:objectMap [
      rml:reference "id"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate dc:title ;
    rr:objectMap [
      rml:reference "title"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:milestoneDueDate ;
    rr:objectMap [
      rml:reference "dueDate"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate dc:description ;
    rr:objectMap [
      rml:reference "description"
    ]
  ].
      
<TenderPeriodMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].tender"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{id}/period" ;
    rr:class ocds:Period
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:durationInDays ;
    rr:objectMap [
      rml:reference "tenderPeriod.durationInDays"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:endDate;
    rr:objectMap [
      rml:reference "tenderPeriod.endDate"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:startDate;
    rr:objectMap [
      rml:reference "tenderPeriod.startDate"
    ]
  ].


# *******************
# Award mapping rules
# *******************

<AwardMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].awards.[*]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/award/{id}" ;
    rr:class ocds:Award
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:awardId ;
    rr:objectMap [
      rml:reference "id"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:awardDate ;
    rr:objectMap [
      rml:reference "date"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate dc:title ;
    rr:objectMap [ 
      rml:reference "title" 
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasAwardValue ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{id}/value"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:awardStatus ;
    rr:objectMap [
      rml:reference "status"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate dc:description ;
    rr:objectMap [ 
      rml:reference "description" 
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasAwardedContractPeriod ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{id}/contractPeriod"
    ]
  ];
  
  rr:predicateObjectMap [
    rr:predicate ocds:hasAwardedItem ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{id}/item/{tender.items.[*].id}"
    ]
  ];
    
  rr:predicateObjectMap [
    rr:predicate ocds:hasAwardPeriod ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{id}/period"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasDocument ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{id}/document"
    ]
  ];
    
  rr:predicateObjectMap [
    rr:predicate ocds:isIssuedForTender ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{tbfy_tender_id}"
    ]
  ].
   
<AwardSupplierMap>  
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[0].awards.[*].suppliers.[*]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/award/{tbfy_award_id}/supplier/{tbfy_id}" ;
    rr:class ocds:Organisation
  ];
    
  rr:predicateObjectMap [
    rr:predicate ocds:legalName;
    rr:objectMap [
      rml:reference "name"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasContactPoint ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{tbfy_award_id}/supplier/{tbfy_id}/contactPoint"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasAddress ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{tbfy_award_id}/supplier/{tbfy_id}/address"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:isSupplierFor ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{tbfy_award_id}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:playsRoleIn ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contractingProcess/{tbfy_ocid}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate owl:sameAs ;
    rr:objectMap [
      rr:template  "http://data.tbfy.eu/company/{tbfyOpenCorporatesJurisdiction}/{tbfyOpenCorporatesCompanyNumber}"
    ]
  ].


# *************************************************************************
# ALL MAPPING RULES BELOW NEED TO BE CHECKED AND UPDATED (WORK IN PROGRESS)
# *************************************************************************

<TenderAmendmentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].tender"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tender.id}/amendment/{amendment.id}" ;
    rr:class ocds:Amendment 
  ].

<TenderMilestoneDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].tender"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tender.id}/milestone/{tender.milestones.[*].id}/document/{document.id}" ;
    rr:class ocds:Document
  ].

<SupplierAddressMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{tbfyOcid}/award/{tbfyAwardId}/supplier/{name}/address" ;
    rr:class ocds:Address
  ];

  rr:predicateObjectMap [
    rr:predicate schema:addressLocality ;
    rr:objectMap [
      rml:reference "address.locality" 
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate schema:postalCode ;
    rr:objectMap [
      rml:reference "address.postalCode" 
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate schema:addressCountry ;
    rr:objectMap [
      rml:reference "address.countryName" 
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate schema:streetAddress ;
    rr:objectMap [
      rml:reference "address.streetAddress" 
    ]
  ].

<AwardAmendmentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].award"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/award/{awards.[*].id}/amendment" ;
    rr:class ocds:Amendment 
  ].

<ContractMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*]"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contract/{contracts.[*].id}" ;
    rr:class ocds:Contract
  ];
  
  rr:predicateObjectMap [
    rr:predicate dc:title ;
    rr:objectMap [ 
      rml:reference "contract.title" 
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate dc:description ;
    rr:objectMap [ 
      rml:reference "contract.description" 
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasContractedItem ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contract/{contracts.[*].id}/item/{$.tender.items.[*].id}"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasContractImplementation ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contract/{contracts.[*].id}/contractImplementation"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasContractPeriod ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contract/{contracts.[*].id}/contractPeriod"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasContractValue ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contract/{contracts.[*].id}/contractValue"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasMilestone ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contract/{contracts.[*].id}/contractMilestone"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:isIssuedForAward ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/award/{awards.[*].id}"
    ]
  ].

<ContractAmendmentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].contract"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contract/{contracts.[*].id}/amendment" ;
    rr:class ocds:Amendment 
  ].

<BidMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].bid"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/bid" ;
    rr:class ocds:Bid
  ];
  
  rr:predicateObjectMap [
    rr:predicate ocds:hasBidValue ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/ocds/{ocid}/bidValue"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasDocument ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/ocds/{ocid}/bidDocument"
    ]
  ].

<BudgetMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].budget"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/budget" ;
    rr:class ocds:Budget
  ];
  
  rr:predicateObjectMap [
    rr:predicate ocds:hasAmount ;
    rr:objectMap [
      rml:reference "planning.budget.amount.amount"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasCurrency;
    rr:objectMap [
      rml:reference "planning.budget.amount.currency"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate ocds:hasReservedValue;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/ocds/{ocid}/budget/reservedValue"
    ]
  ].
   
<SupplierContactpointMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].supplier"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{tbfyOcid}/award/{tbfyAwardId}/supplier/{name}/contactPoint";
    rr:class ocds:ContactPoint ;
    rr:class ocds:Person
  ];
  
  rr:predicateObjectMap [
    rr:predicate schema:addressLocality ;
    rr:objectMap [
      rml:reference "address.locality"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:postalCode ;
    rr:objectMap [
      rml:reference "address.postalCode"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:addressCountry;
    rr:objectMap [
      rml:reference "$.address.countryName"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:streetAddress ;
    rr:objectMap [
      rml:reference "address.streetAddress"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:email ;
    rr:objectMap [
      rml:reference "contactPoint.email"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:name ;
    rr:objectMap [
      rml:reference "contactPoint.name"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:telephone ;
    rr:objectMap [
      rml:reference "contactPoint.telephone"
    ]
  ];

  rr:predicateObjectMap [
    rr:predicate schema:faxNumber ;
    rr:objectMap [
      rml:reference "contactPoint.faxNumber"
    ]
  ].

<DiscussionMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].discussion"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/discussion";
    rr:class ocds:Discussion
  ].

<AwardDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].award"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/award/{awards.[*].id}/document" ;
    rr:class ocds:Document
  ].

<BidDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].bid"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/bid/document";
    rr:class ocds:Document
  ].

<ContractDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].contract"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/contract/document";
    rr:class ocds:Document
  ].

<ImplementationDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].implementation"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/implementation/document";
    rr:class ocds:Document
  ].

<ContractMilestoneDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].contract"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contract/{contract.id}/milestone/{milestone.id}/document/{document.id}" ;
    rr:class ocds:Document
  ].

<ImplementationMilestoneDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].implementation"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/implementation/{implementation.id}/milestone/{milestone.id}/document/{document.id}" ;
    rr:class ocds:Document
  ].

<PlanDocumentMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].plan"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/plan/{plan.id}/document/{document.id}" ;
    rr:class ocds:Document
  ];
    
  rr:predicateObjectMap [
    rr:predicate ocds:documentId ;
    rr:objectMap [
      rml:reference "planning.documents.[*].id"
    ]
  ];
    
  rr:predicateObjectMap [
    rr:predicate ocds:documentType ;
    rr:objectMap [
      rml:reference "planning.documents.[*].documentType"
    ]
  ];
    
  rr:predicateObjectMap [
    rr:predicate dc:language ;
    rr:objectMap [
      rml:reference "planning.documents.[*].language"
    ]
  ];
    
  rr:predicateObjectMap [
    rr:predicate schema:URL ;
    rr:objectMap [
      rml:reference "planning.documents.[*].url"
    ]
  ].
    
<ImplementationMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].implementation"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/implementation/{implementation.id}" ;
    rr:class ocds:Implementation
  ];
   
  rr:predicateObjectMap [
    rr:predicate ocds:hasMilestone ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/implementation/{implementation.id}/milestone/{milestone.id}"
    ]
  ];
     
  rr:predicateObjectMap [
    rr:predicate ocds:hasTransaction ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/implementation/{implementation.id}/transaction/{transaction.id}"
    ]
  ].

<AwardItemMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].award"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/item/{tender.items.[*].id}" ;
    rr:class ocds:Item
  ];
     
  rr:predicateObjectMap [
    rr:predicate ocds:hasClassificaton ;
    rr:objectMap [
      rml:reference "tender.items.[*].classification.id"^^xsd:string
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:classificatonScheme ;
    rr:objectMap [
      rml:reference "tender.items.[*].classification.scheme"
    ]
  ];
   
  rr:predicateObjectMap [
    rr:predicate ocds:hasRelatedEnquiry ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/ocds/{ocid}/item/{tender.items.[*].classification.id}/enquiry"
    ]
  ];
     
  rr:predicateObjectMap [
    rr:predicate ocds:hasAdditionalItemClassificaton ;
    rr:objectMap [
      rml:reference "tender.items.[*].additionalClassifications.[*].id"^^xsd:string
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:additionalItemClassificatonScheme ;
    rr:objectMap [
      rml:reference "tender.items.[*].additionalClassifications.[*].scheme"
    ]
  ];
     
  rr:predicateObjectMap [
    rr:predicate ocds:itemId ;
    rr:objectMap [
      rml:reference "tender.items.[*].classification.id"^^xsd:string
    ]
  ];
          
  rr:predicateObjectMap [
    rr:predicate ocds:isRelatedToLot ;
    rr:objectMap [
      rml:reference "tender.items.[*].relatedLot"
    ]
  ].
  
<LotMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].lot"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tender.id}/lot/{tender.lots.[*].id}" ;
    rr:class ocds:Lot
  ];
     
  rr:predicateObjectMap [
    rr:predicate ocds:hasLotValue ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{tender.id}/lot/value"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasRelatedEnquiry ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{tender.id}/lot/enquiry"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate dc:title ;
    rr:objectMap [
      rml:reference "tender.lots.[*].title"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate dc:description ;
    rr:objectMap [
      rml:reference "tender.lots.[*].description"
    ]
  ].

<ContractMilestoneMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].contract"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contract/milestone" ;
    rr:class ocds:Milestone
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasDocument ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/contract/milestone/document"
    ]
  ].

<ImplementationMilestoneMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].implementation"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/tender/{tender.id}/implementation/milestone" ;
    rr:class ocds:Milestone
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasDocument ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/tender/{tender.id}/implementation/milestone/{tender.milestones.[*].title}/document"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:milestoneDueDate ;
    rr:objectMap [
      rml:reference "tender.milestones.[*].dueDate"
    ]
  ].
 
<PlanningMilestoneMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].planning"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/planning/milestone" ;
    rr:class ocds:Milestone
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:hasDocument ;
    rr:objectMap [
      rr:template "http://data.tbfy.eu/ocds/{ocid}/planning/milestone/document"
    ]
  ].

<ContractPeriodMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].contract"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/award/{awards.[*].id}/contractPeriod" ;
    rr:class ocds:Period
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:durationInDays ;
    rr:objectMap [
      rml:reference "awards.[*].contractPeriod.durationInDays"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:endDate ;
    rr:objectMap [
      rml:reference "awards.[*].contractPeriod.endDate"
    ]
  ];
      
  rr:predicateObjectMap [
    rr:predicate ocds:startDate ;
    rr:objectMap [
      rml:reference "awards.[*].contractPeriod.startDate"
    ]
  ].
  
<TransactionValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].transaction"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/transaction/value" ;
    rr:class ocds:Value
  ].

<AwardValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].award"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/award/{awards.[*].id}/value" ;
    rr:class ocds:Value
  ].
  
<ContractValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].contract"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/contract/value" ;
    rr:class ocds:Value
  ].
    
<LotValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].lot"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/tender/{tender.id}/lot/{tender.lots.[*].id}/value" ;
    rr:class ocds:Value
  ].
   
<BudgetReservedValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].budget"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/budget/reservedValue" ;
    rr:class ocds:Value
  ].
    
<BidValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].bid"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/bid/value" ;
    rr:class ocds:Value
  ].
      
<BudgetValueMap>
  a rr:TriplesMap ;

  rml:logicalSource [
    rml:source "input.json" ; 
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.json.releases.[*].budget"
  ];

  rr:subjectMap [
    rr:template "http://data.tbfy.eu/ocds/{ocid}/budget/value" ;
    rr:class ocds:Value
  ].
